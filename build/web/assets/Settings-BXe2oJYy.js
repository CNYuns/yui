import{d as R,r as u,a as $,o as j,b as d,e as O,f as s,g as a,w as e,i as l,k as o,t as r,E as f,j as T,_ as z}from"./index-Cagw-rQE.js";const D={class:"page-container"},I={class:"control-item"},J={class:"control-item"},U={class:"config-preview"},q=R({__name:"Settings",setup(A){const p=u(!1),_=u(!1),m=u(!1),g=u(!1),S=u(""),y=u(""),i=$({hostname:"",platform:"",os:"",arch:"",uptime:0});j(async()=>{await v(),await k()});async function v(){try{const n=await d.system.getStatus();Object.assign(i,n.data),g.value=n.data.xray_running,S.value=n.data.xray_version}catch(n){console.error(n)}}async function k(){m.value=!0;try{const n=await d.system.getConfig();y.value=JSON.stringify(n.data,null,2)}catch{y.value="加载失败"}finally{m.value=!1}}async function X(){p.value=!0;try{await d.system.reload(),f.success("配置重载成功"),await v()}catch(n){f.error(n.message)}finally{p.value=!1}}async function N(){_.value=!0;try{await d.system.restart(),f.success("Xray 重启成功"),await v()}catch(n){f.error(n.message)}finally{_.value=!1}}function V(n){if(!n)return"0秒";const t=Math.floor(n/86400),w=Math.floor(n%86400/3600),x=Math.floor(n%3600/60);return`${t}天 ${w}时 ${x}分`}return(n,t)=>{const w=l("el-tag"),x=l("el-divider"),b=l("el-button"),B=l("el-space"),h=l("el-card"),C=l("el-col"),c=l("el-descriptions-item"),E=l("el-descriptions"),M=l("el-row");return T(),O("div",D,[t[8]||(t[8]=s("div",{class:"page-header"},[s("h2",null,"系统设置")],-1)),a(M,{gutter:20},{default:e(()=>[a(C,{span:12},{default:e(()=>[a(h,null,{header:e(()=>[...t[0]||(t[0]=[s("span",null,"Xray 控制",-1)])]),default:e(()=>[s("div",I,[t[1]||(t[1]=s("span",null,"运行状态:",-1)),a(w,{type:g.value?"success":"danger",size:"large"},{default:e(()=>[o(r(g.value?"运行中":"已停止"),1)]),_:1},8,["type"])]),s("div",J,[t[2]||(t[2]=s("span",null,"Xray 版本:",-1)),s("span",null,r(S.value),1)]),a(x),a(B,null,{default:e(()=>[a(b,{type:"primary",onClick:X,loading:p.value},{default:e(()=>[...t[3]||(t[3]=[o(" 重载配置 ",-1)])]),_:1},8,["loading"]),a(b,{type:"warning",onClick:N,loading:_.value},{default:e(()=>[...t[4]||(t[4]=[o(" 重启 Xray ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),a(C,{span:12},{default:e(()=>[a(h,null,{header:e(()=>[...t[5]||(t[5]=[s("span",null,"系统信息",-1)])]),default:e(()=>[a(E,{column:1,border:""},{default:e(()=>[a(c,{label:"主机名"},{default:e(()=>[o(r(i.hostname),1)]),_:1}),a(c,{label:"平台"},{default:e(()=>[o(r(i.platform),1)]),_:1}),a(c,{label:"系统/架构"},{default:e(()=>[o(r(i.os)+"/"+r(i.arch),1)]),_:1}),a(c,{label:"运行时间"},{default:e(()=>[o(r(V(i.uptime)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(M,{gutter:20,style:{"margin-top":"20px"}},{default:e(()=>[a(C,{span:24},{default:e(()=>[a(h,null,{header:e(()=>[...t[6]||(t[6]=[s("span",null,"当前 Xray 配置",-1)])]),default:e(()=>[a(b,{onClick:k,loading:m.value,style:{"margin-bottom":"10px"}},{default:e(()=>[...t[7]||(t[7]=[o(" 刷新配置 ",-1)])]),_:1},8,["loading"]),s("pre",U,r(y.value),1)]),_:1})]),_:1})]),_:1})])}}}),G=z(q,[["__scopeId","data-v-a0fb66c4"]]);export{G as default};
