import{d as I,r as w,a as h,o as N,b as U,e as A,f as y,g as e,w as t,i as s,x as T,y as P,n as j,k as u,t as d,j as z,_ as E}from"./index-Cagw-rQE.js";const L={class:"page-container"},M=I({__name:"Audit",setup(q){const _=w(!1),g=w([]),i=h({page:1,pageSize:20,total:0}),c=h({action:"",resource:""});N(()=>{p()});async function p(){_.value=!0;try{const r=await U.audit.list({page:i.page,page_size:i.pageSize,action:c.action||void 0,resource:c.resource||void 0});g.value=r.data.list,i.total=r.data.total}finally{_.value=!1}}function V(r){return{create:"success",update:"warning",delete:"danger",login:"info"}[r]||"info"}function C(r){return new Date(r).toLocaleString("zh-CN")}return(r,l)=>{const o=s("el-option"),f=s("el-select"),m=s("el-form-item"),D=s("el-form"),n=s("el-table-column"),b=s("el-tag"),x=s("el-table"),S=s("el-pagination"),k=s("el-card"),B=P("loading");return z(),A("div",L,[l[4]||(l[4]=y("div",{class:"page-header"},[y("h2",null,"审计日志")],-1)),e(k,null,{default:t(()=>[e(D,{inline:!0,class:"filter-form"},{default:t(()=>[e(m,{label:"操作类型"},{default:t(()=>[e(f,{modelValue:c.action,"onUpdate:modelValue":l[0]||(l[0]=a=>c.action=a),placeholder:"全部",clearable:"",onChange:p},{default:t(()=>[e(o,{label:"创建",value:"create"}),e(o,{label:"更新",value:"update"}),e(o,{label:"删除",value:"delete"}),e(o,{label:"登录",value:"login"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"资源类型"},{default:t(()=>[e(f,{modelValue:c.resource,"onUpdate:modelValue":l[1]||(l[1]=a=>c.resource=a),placeholder:"全部",clearable:"",onChange:p},{default:t(()=>[e(o,{label:"用户",value:"user"}),e(o,{label:"客户端",value:"client"}),e(o,{label:"入站",value:"inbound"}),e(o,{label:"出站",value:"outbound"}),e(o,{label:"证书",value:"certificate"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),T((z(),j(x,{data:g.value},{default:t(()=>[e(n,{prop:"id",label:"ID",width:"60"}),e(n,{prop:"created_at",label:"时间",width:"180"},{default:t(({row:a})=>[u(d(C(a.created_at)),1)]),_:1}),e(n,{label:"用户",width:"150"},{default:t(({row:a})=>{var v;return[u(d(((v=a.user)==null?void 0:v.email)||"-"),1)]}),_:1}),e(n,{prop:"action",label:"操作",width:"100"},{default:t(({row:a})=>[e(b,{type:V(a.action),size:"small"},{default:t(()=>[u(d(a.action),1)]),_:2},1032,["type"])]),_:1}),e(n,{prop:"resource",label:"资源",width:"100"}),e(n,{prop:"resource_id",label:"资源ID",width:"80"}),e(n,{prop:"ip",label:"IP地址",width:"140"}),e(n,{prop:"status",label:"状态",width:"80"},{default:t(({row:a})=>[e(b,{type:a.status==="success"?"success":"danger",size:"small"},{default:t(()=>[u(d(a.status),1)]),_:2},1032,["type"])]),_:1}),e(n,{prop:"detail",label:"详情","show-overflow-tooltip":""})]),_:1},8,["data"])),[[B,_.value]]),e(S,{class:"pagination","current-page":i.page,"onUpdate:currentPage":l[2]||(l[2]=a=>i.page=a),"page-size":i.pageSize,"onUpdate:pageSize":l[3]||(l[3]=a=>i.pageSize=a),total:i.total,layout:"total, prev, pager, next",onCurrentChange:p},null,8,["current-page","page-size","total"])]),_:1})])}}}),G=E(M,[["__scopeId","data-v-4c7a7282"]]);export{G as default};
