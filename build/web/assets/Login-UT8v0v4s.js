import{d as x,u as V,r as u,a as U,o as z,b as L,c as M,e as c,f as o,g as s,w as l,h as B,i as r,j as p,k as C,E as v,_ as E}from"./index-Cagw-rQE.js";const I={class:"login-container"},N={key:0,class:"login-box"},R={key:1,class:"login-box"},S=x({__name:"Login",setup(q){const m=M(),w=V(),f=u(),n=u(!1),g=u(!0),a=U({email:"",password:""}),y={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]};z(async()=>{try{(await L.auth.check()).data.initialized||m.replace("/init")}catch{}finally{g.value=!1}});async function b(){var e;if(await((e=f.value)==null?void 0:e.validate().catch(()=>!1))){n.value=!0;try{await w.login(a.email,a.password),v.success("登录成功"),m.push("/")}catch(t){v.error(t.message||"登录失败")}finally{n.value=!1}}}return(_,e)=>{const t=r("el-input"),i=r("el-form-item"),h=r("el-button"),k=r("el-form");return p(),c("div",I,[g.value?(p(),c("div",R,[...e[4]||(e[4]=[o("div",{class:"login-header"},[o("h1",null,"Y-UI"),o("p",null,"正在检查系统状态...")],-1)])])):(p(),c("div",N,[e[3]||(e[3]=o("div",{class:"login-header"},[o("h1",null,"Y-UI"),o("p",null,"Xray 管理面板")],-1)),s(k,{ref_key:"formRef",ref:f,model:a,rules:y,onSubmit:B(b,["prevent"])},{default:l(()=>[s(i,{prop:"email"},{default:l(()=>[s(t,{modelValue:a.email,"onUpdate:modelValue":e[0]||(e[0]=d=>a.email=d),placeholder:"邮箱",size:"large","prefix-icon":"Message"},null,8,["modelValue"])]),_:1}),s(i,{prop:"password"},{default:l(()=>[s(t,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=d=>a.password=d),type:"password",placeholder:"密码",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),s(i,null,{default:l(()=>[s(h,{type:"primary",size:"large",loading:n.value,"native-type":"submit",class:"login-btn"},{default:l(()=>[...e[2]||(e[2]=[C(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]))])}}}),j=E(S,[["__scopeId","data-v-92aad5c7"]]);export{j as default};
