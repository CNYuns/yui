import{d as y,r as f,a as V,e as x,f as n,g as s,i as l,w as a,h,k as P,b as k,E as c,c as C,j as I,_ as z}from"./index-Cagw-rQE.js";const E={class:"init-container"},U={class:"init-box"},q=y({__name:"Init",setup(B){const _=C(),u=f(),d=f(!1),o=V({email:"",password:"",confirmPassword:""}),g={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(p,e,r)=>{e!==o.password?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]};async function w(){var e;if(await((e=u.value)==null?void 0:e.validate().catch(()=>!1))){d.value=!0;try{await k.auth.initAdmin(o.email,o.password),c.success("管理员创建成功，请登录"),_.push("/login")}catch(r){c.error(r.message||"初始化失败")}finally{d.value=!1}}}return(p,e)=>{const r=l("el-alert"),m=l("el-input"),i=l("el-form-item"),v=l("el-button"),b=l("el-form");return I(),x("div",E,[n("div",U,[e[4]||(e[4]=n("div",{class:"init-header"},[n("h1",null,"Y-UI"),n("p",null,"初始化管理员账号")],-1)),s(r,{type:"info",title:"首次使用",description:"检测到系统尚未初始化，请创建管理员账号",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}}),s(b,{ref_key:"formRef",ref:u,model:o,rules:g,onSubmit:h(w,["prevent"])},{default:a(()=>[s(i,{prop:"email"},{default:a(()=>[s(m,{modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=t=>o.email=t),placeholder:"管理员邮箱",size:"large","prefix-icon":"Message"},null,8,["modelValue"])]),_:1}),s(i,{prop:"password"},{default:a(()=>[s(m,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=t=>o.password=t),type:"password",placeholder:"密码（至少6位）",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),s(i,{prop:"confirmPassword"},{default:a(()=>[s(m,{modelValue:o.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>o.confirmPassword=t),type:"password",placeholder:"确认密码",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),s(i,null,{default:a(()=>[s(v,{type:"primary",size:"large",loading:d.value,"native-type":"submit",class:"init-btn"},{default:a(()=>[...e[3]||(e[3]=[P(" 创建管理员 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),R=z(q,[["__scopeId","data-v-59ec397e"]]);export{R as default};
